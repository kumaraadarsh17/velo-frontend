<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css" />
    <title>Login Form</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
    <h1>v√©lo</h1><br>
    <div class="login">
        <form id="login">
            <label><b>User Name
                </b>
            </label>
            <input type="text" name="rollNumber" id="rollNumber" placeholder="Username">
            <br><br>
            <label><b>Password
                </b>
            </label>
            <input type="Password" name="password" id="password" placeholder="Password">
            <br><br>
            <button type="submit" class="button" id="log-btn">Log in</button>
            <br><br>
            <!-- <input type="checkbox" id="check">
            <span>Remember me</span>
            <br><br>
            <a href="#">Forgot Password</a> -->
        </form>
    </div>

    <script type="text/javascript">
        if (localStorage.getItem('token') != null) {
            window.location.href = './main page/index.html';
        }
        const form = document.getElementById('login');

        form.addEventListener('submit', async function (e) {
            // Prevent default behavior:
            e.preventDefault();
            // Create payload as new FormData object:
            const payload = new FormData(form);
            // Post the payload using Fetch:
            const response = await fetch('http://localhost:8080/authenticate', {
                method: 'POST',
                body: JSON.stringify({ rollNumber: payload.get('rollNumber'), password: payload.get('password') })
            })
            const data = await response.json();
            const token = data.token;
            localStorage.setItem('token', token);
            localStorage.setItem('currentUser', payload.get('rollNumber'));
            window.location.href = '/main page/index.html';
        })
    </script>
</body>

</html>